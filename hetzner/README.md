# Hetzner Infrastructure

Terraform configuration for Hetzner Cloud resources. This is a **manually operated** layer - NOT applied by CI.

## Resources

- **tikpannu server** - NixOS VM hosting Discourse and Telegram bots
- **Storage Box** - Backup storage for the backup system

## Prerequisites

1. Azure CLI authenticated (`az login`) - for backend state access
2. Hetzner Cloud API token (`export HCLOUD_TOKEN="..."`)

## Usage

```bash
cd hetzner/
az login
export HCLOUD_TOKEN="your-token"
terraform init
terraform plan
terraform apply
```

## Retrieving the Storage Box Password

The password is generated by Terraform and stored in state. To retrieve it:

```bash
terraform output -raw storagebox_password
```

## Initial Import

To import existing resources, uncomment and fill in the import blocks in `main.tf`:

```hcl
import {
  to = hcloud_server.tikpannu
  id = "<SERVER_ID>"
}

import {
  to = hcloud_storage_box.backup
  id = "<STORAGE_BOX_ID>"
}
```

Then run `terraform plan` and `terraform apply`. After successful import, remove or comment out the import blocks.

## Finding Resource IDs

```bash
# Server ID
hcloud server list

# Storage Box ID - check Hetzner Console
```
